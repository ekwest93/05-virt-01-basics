# 05-virt-01-basics
Домашнее задание к занятию 1. «Введение в виртуализацию»

## Задача 1

Ознакомьтесь с [инструкцией ](https://github.com/netology-code/devops-materials/blob/master/cloudwork.MD) по экономии облачных ресурсов.


1. Создайте через web-интерфейс Yandex Cloud - VPC и виртуальную машину из инструкции конфигурации "эконом-ВМ" с публичным ip-адресом. В пункте "Выбор образа/загрузочного диска" выберите вкладку "Cloud Marketplace" , щелкните "Посмотреть больше", найдите образ "Yandex Cloud Toolbox".
2. Убедитесь, что вы можете подключиться к консоли ВМ через ssh, используя публичный ip-адрес. Убедитесь, что на ВМ установлен Docker с помощью команды ```docker --version```(команду выполните от имени root пользователя) !
3. Узнайте в инструкции Яндекс, какие еще инструменты предустановлены в данном образе.
4. Оставьте ВМ работать, пока она не выключится самостоятельно! Опция "прерываемая" выключит ее не позже чем через 24 часа. 
5. Для наглядности подождите еще 1 сутки.
6. Перейдите по [ссылке ](https://console.cloud.yandex.ru/billing?section=accounts). Выберите свой платежный аккаунт. Перейдите на вкладку детализация (фильтр "По продуктам") и оцените график потребления финансов.
7. Удалите ВМ или пользуйтесь ею при выполнении последующих домашних заданий курса обучения.

## Решение 1.
**Ознакомилась с [инструкцией](https://github.com/netology-code/devops-materials/blob/master/cloudwork.MD) по экономии облачных ресурсов, затем выполнила задачу 1 по шагам** 

## Задача 2

Выберите один из вариантов использования организации физических серверов в зависимости от условий использования.

Организация серверов:

- физические сервера,
- паравиртуализация,
- виртуализация уровня ОС.

Условия использования:

- высоконагруженная база данных, чувствительная к отказу;
- различные web-приложения;
- Windows-системы для использования бухгалтерским отделом;
- системы, выполняющие высокопроизводительные расчёты на GPU.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

## Решение 2.
* высоконагруженная база данных, чувствительная к отказу:

В данном случае я бы использовал физические серверы с быстрой дисковой подсистемой, т.к. база данных чувствительна к количеству операция ввода-вывода в секунду (IOPS). Саму базу данных создавал бы в виде кластера, например под управлением Patroni в случае использования PostgreSQL. 

Либо паравиртуальный кластер ESXi под управлением VMware vCenter. vCenter позволил бы настроить кластеризацию физических серверов так, что имея общий Datastore виртуальных машин, размещенный на СХД, при падении одного из серверов, его виртуальные машины перемещались бы на другой сервер кластера, без отказа виртуальных машин и почти без падения производительности. Технология называется VMWare vMotion.

Выбор решения будет зависеть от бюджета организации.

* различные web-приложения:

В данном случае я бы использовал виртуализацию уровня ОС. Все современные Web приложения существуют и для операционных систем, основанных на ядре Linux. Виртуализация уровня ОС позволила бы гибко управлять ресурсами контейнеров, легко настраивать сетевой стек и взаимодействие между разными контейнерами. В случае если потребовалось бы запустить Web приложение, которого не существует для операционных систем на ядре Linux, то тогда пришлось бы прибегнуть к паравиртуализации.

* Windows-системы для использования бухгалтерским отделом:

В данном случае нужно предметно рассматривать, что это за бухгалтерские приложения и с каким базами данных они работают. Но обычно это не сильно нагруженные приложения и базы данных. Лучше всего по моему мнению подойдет паравиртуализация. Можно будет гибко управлять выделяемыми бухгалтерским виртуальным машина ресурсами, выполнять их резервное копирование и при возможности настроить кластеризацию. Сами виртуальные машины можно запускать как для приложений на ОС Windows, так и Linux подобные операционные системы.  

* системы, выполняющие высокопроизводительные расчёты на GPU:

В данном случае считаю необходимым использовать только физический сервер, т.к. видеокарты с GPU будут лучше взаимодействовать напрямую с операционной системой. Виртуализация может снизить эффективность использования вычислительных ресурсов.  

## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based-инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
2. Требуется наиболее производительное бесплатное open source-решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows-инфраструктуры.
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

## Решение 3.

1. В этом сценарии подойдет как решение VMware ESXi, так и Hyper-V. Обе системы виртуализации поддерживают описанные требования. Но поскольку используется преимущественно Windows based-инфраструктура, то приоритетным бы я выбрал Hyper-V. К тому же в Hyper-V можно выполнять резервное копирование виртуальных машин встроенным в Windows инструментом - Windows Server Backup. А для резервного копирования виртуальных машин из ESXi потребуется использовать стороннее ПО, например, Veeam Backup & Replication.

2. В этом сценарии подойдет любое решение на базе KVM. Например, Proxmox Virtual Environment. Это решение основано на ядре операционной системы Debian, постоянно разрабатывается и улучшается, есть довольно обширное комьюнити.

3. В этом сценарии наиболее подойдет Xen PV, т.к. однотипные виртуальные машины Windows можно разворачивать, основываясь на шаблонах. К тому же это бесплатный и достаточно зрелый продукт. Если удобство разворачивания виртуальных машин из шаблонов не важно, то можно использовать KVM.

4. В этом сценарии наиболее подойдет виртуализация на уровне ОС, например, Docker. На операционной системе c ядром Linux можно запускать разные контейнеры с другими версиями Linux, например, Alpine c openjdk11 для запуска и тестирования Java приложений.

## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

## Решение 4.

При создании гетерогенной среды виртуализации повышаются требования к обслуживающему персоналу, вместо одной системы приходится обслуживать две или более. Подходы к их обслуживанию могут значительно отличаться, что в некоторых организациях может вызвать путаницу в зависимости от используемых технологий и квалификации персонала.

В случае использования проприетарных (защищенных лицензией, а значит платных) систем увеличиваются издержки на серверное программное обеспечение. Работа с виртуальными машинами будет осложнена тем, что придется использовать различные инструменты. Например, для резервного копирования виртуальной машины из Proxmox не требуется особого программного обеспечения, копирование выполняется просто в папку или на сетевой диск, но сам процесс копирования и восстановления выполнен неудобно и резервная копия занимает весь объем виртуальной машины (занятое место + свободное).
В то время как при использовании ESXi для резервного копирования потребуется использовать стороннее программное обеспечение, например Veeam Backup & Replication. Но работа в этой среде значительно удобнее и дает больше возможностей при выполнении резервного копирования и восстановления, а также в этой среде объем резервной копии виртуальной машины будут занимать только "полезные" данные, без свободного места разделов диска.

Также усложняется процесс миграции виртуальной машины с сервера на сервер. Чтобы переместить виртуальную машину, например из ESXi в Proxmox, нужно выполнить конвертацию ВМ из одного формата в другой. Сами конвертеры могут требовать для работы разные операционные системы и могут быть платными.

Чтобы минимизировать риски обслуживания гетерогенных систем нужно слишком важные виртуальные машины держать в какой-то одной более продвинутой и удобной среде виртуализации, которая поддерживают кластеризацию, удобное резервное копирование и восстановление и подходят для использования этих виртуальных машин.

Лично я использую гетерогенную среду виртуализации, но делаю это лишь ради изучения и сравнения их друг с другом. На своей работе имею 8 серверов с ESXi под управлением VMware vCenter и 1 сервер Proxmox. Proxmox был выбран потому, что он бесплатный и рассматривался как альтернатива ESXi, но выяснилось, что работать с ним менее удобно и для переноса всех виртуальных машин не подходит. Да и конвертация виртуальных машин займет значительное время.

Также использую на своем рабочем компьютере Oracle VM VirtualBox, но делаю это лишь для изучения каких-то отдельных дистрибутивов операционных систем или программ, работающих в этих системах. Oracle VM VirtualBox также может быть отличным инструментом для изучения Kubernetes.
